<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>
<div id="canvas-wrap">
   <canvas id="canvas" style="border:1px solid #aaaaaa; display: block;margin:50px auto;">
   	your browser does not support canvas
   </canvas>
</div>
</body>
<script type="text/javascript">
    var colorList = [
     '#C1232B','#B5C334','#FCCE10','#E87C25','#27727B',
     '#FE8463','#9BCA63','#FAD860','#F3A43B','#60C0DD',
     '#D7504B','#C6E579','#F4E001','#F0805A','#26C0C0'
     ];



    var myCanvas = document.getElementById("canvas");
    var context = myCanvas.getContext("2d");
    function Particle(x=10,y=10,radius=10,vx=20,vy=30,mass=0.1,color){
        this.x = x;
        this.y = y;
        this.radius = radius;
        this.vx = vx;
        this.vy = vy;
        this.mass = mass;
        this.color=color;
    }
    Particle.prototype.INFINITY = Number.POSITIVE_INFINITY;
    function  generateParticle(){
        var x = 10;
        var y = 10;
        var radius = 20;
        var vx = Math.random()*10+10;
        var vy = Math.random()*10+10;
        var mass = 10;
        var color = colorList[Math.floor(Math.random()*colorList.length)];
        return new Particle(x,y,radius,vx,vy,mass,color);
    }
    function getParticleGroup(n){
        var arr = [];
        for(var i=0;i<n;i++){
          arr.push(generateParticle());
        }
        return arr;
    }
    var particles =  getParticleGroup(5);
    Particle.prototype.draw = function(){
        DrawTool.ctx.fillStyle = this.color;
        DrawTool.fillCycle(this.x,this.y,this.radius);
        DrawTool.ctx.fill();
    }
    Particle.prototype.move = function(dt){
        this.x +=this.vx*dt;
        this.y +=this.vy*dt;
        if(DrawTool.width<=this.x+this.radius || this.x<=this.radius){
            this.vx = -this.vx;
        }
        if(DrawTool.height<=this.y+this.radius || this.y<=this.radius){
            this.vy = -this.vy;
        }
    }
    Particle.prototype.timeToHitVerticalWall = function(){
        
    }

    var Point = function(x,y){
        this.x = x;
        this.y = y;
    }
    var DrawTool = {}
    DrawTool.canvas = myCanvas;
    DrawTool.ctx = context;

    DrawTool.iniCanvas = function(width=800,height=600){
        this.width = width;
        this.height = height;
    	this.canvas.width = width;
    	this.canvas.height = height;
    }
    DrawTool.line = function(p1,p2,width=0.1,color="#AA394C"){
         this.ctx.moveTo(p1.x,p1.y);
         this.ctx.lineTo(p2.x,p2.y);
         this.ctx.strokeStyle=color;
         this.ctx.lineWidth=width;
    }
    DrawTool.clear = function(){
    	this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
    }
    DrawTool.beginPath = function(){
    	 this.ctx.beginPath();
    }
    DrawTool.fillCycle = function(rx,ry,radius){
         this.beginPath();
         this.ctx.arc(rx, ry, radius, 0, Math.PI*2, true);
         this.stroke();
    }
    DrawTool.stroke = function(){
         this.ctx.stroke();
    }
    function drawBox(){
    	 DrawTool.beginPath();
    	 var height = 600;
		 var width = 800;
         DrawTool.iniCanvas(width,height);
         var columnNum = 80;
         var rowNum = 60;
         var columnWidth = Math.floor(width/columnNum);
         var rowWidth = Math.floor(height/rowNum);
         for(var i=1;i<columnNum;i++){
                 var p1 = new Point(i*columnWidth,0);
                 var p2 = new Point(i*columnWidth,height);
                 DrawTool.line(p1,p2);
         }
         for(var i=1;i<rowNum;i++){
                 var p1 = new Point(0,i*rowWidth);
                 var p2 = new Point(width,i*rowWidth);
                 DrawTool.line(p1,p2);
         }
         DrawTool.stroke();
    }
     
    
    var CollisionSystem = {};
    CollisionSystem.particle = new Particle();
    CollisionSystem.particles = particles;
    CollisionSystem.particlesDraw = function(){
        for(var i=0;i<this.particles.length;i++){
            this.particles[i].draw();
            this.particles[i].move(1);
        }
    }
    
    CollisionSystem.silumate = function(){
        // this.particle.draw();
        // this.particle.move(1);
        this.particlesDraw();
     }

    
 
	window.onload = function(){
		drawBox();
        setInterval(function(){
          DrawTool.clear();
          CollisionSystem.silumate();
        },30);
	    }
</script>
</html>

